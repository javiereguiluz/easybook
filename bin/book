#!/usr/bin/env php
<?php

/*
 * This file is part of the easybook application.
 *
 * (c) Javier Eguiluz <javier.eguiluz@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

use Easybook\DependencyInjection\ContainerFactory;
use Symfony\Component\Console\Application;
use Symfony\Component\Console\Input\ArgvInput;
use Symplify\PackageBuilder\Configuration\ConfigFileFinder;

if (!file_exists(__DIR__.'/../vendor/autoload.php')) {
    throw new \RuntimeException(
        "\n"
        ."[ERROR] easybook depends on some external libraries and components.\n"
        ."It seems that those dependencies aren't properly installed.\n\n"
        ."Try 'composer install'"
    );
}

require __DIR__.'/../vendor/autoload.php';

ConfigFileFinder::detectFromInput('easybook', new ArgvInput());
$configFile = ConfigFileFinder::provide('easybook');

if ($configFile) {
    $container = (new ContainerFactory())->createFromConfig();

} else {
    $container = (new ContainerFactory())->create();
}
die;


/** @var Application $application */
$application = $container->get(Application::class);
$application->run();
